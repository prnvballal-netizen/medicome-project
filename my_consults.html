<!DOCTYPE html>
<html>
<head>
  <title>My Consultations</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

<h2>My Doctor Consultations</h2>

<div id="consults"></div>

<script type="module">

import { onAuthStateChanged } from
"https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import { collection, query, where, getDocs } from
"https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

import { auth, db } from "./firebase.js";

// ðŸ” Protect page + load data
onAuthStateChanged(auth, async (user) => {
  if (!user) {
    window.location.href = "login.html";
    return;
  }

  const q = query(
    collection(db, "consultations"),
    where("uid", "==", user.uid)
  );

  const snapshot = await getDocs(q);
  const consultsDiv = document.getElementById("consults");

  if (snapshot.empty) {
    consultsDiv.innerHTML = "<p>No consultations found</p>";
    return;
  }

  snapshot.forEach(doc => {
    const c = doc.data();
    consultsDiv.innerHTML += `
      <div style="border:1px solid #ccc; padding:10px; margin:10px">
        <p><b>Doctor:</b> ${c.doctor}</p>
        <p><b>Specialization:</b> ${c.specialization}</p>
        <p><b>Problem:</b> ${c.problem}</p>
      </div>
    `;
  });
});

</script>

</body>
</html>
