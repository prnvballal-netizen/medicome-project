<!DOCTYPE html>
<html>
<head>
  <title>My Orders</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

<h2>My Medicine Orders</h2>

<div id="orders"></div>

<script type="module">

import { onAuthStateChanged } from
"https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import { collection, query, where, getDocs } from
"https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

import { auth, db } from "./firebase.js";

// ðŸ” Protect page + load data
onAuthStateChanged(auth, async (user) => {
  if (!user) {
    window.location.href = "login.html";
    return;
  }

  const q = query(
    collection(db, "medicineOrders"),
    where("uid", "==", user.uid)
  );

  const snapshot = await getDocs(q);
  const ordersDiv = document.getElementById("orders");

  if (snapshot.empty) {
    ordersDiv.innerHTML = "<p>No orders found</p>";
    return;
  }

  snapshot.forEach(doc => {
    const o = doc.data();
    ordersDiv.innerHTML += `
      <div style="border:1px solid #ccc; padding:10px; margin:10px">
        <p><b>Medicine:</b> ${o.medicine}</p>
        <p><b>Price:</b> â‚¹${o.price}</p>
        <p><b>Address:</b> ${o.address}</p>
      </div>
    `;
  });
});

</script>

</body>
</html>
